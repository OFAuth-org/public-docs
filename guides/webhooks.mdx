---
title: "Webhooks"
description: "Configure OFAuth webhooks, understand event payloads, and process deliveries reliably"
---

## Overview

OFAuth webhooks provide real-time notifications for connection lifecycle changes and dynamic rules updates. They eliminate the need for polling by pushing structured events to your infrastructure whenever something changes in a user's session or in the signing rules landscape.

## Base URL

All webhook management endpoints live under the Account API: `https://api.ofauth.com/v2/account`.

## Configure Webhooks

### Create or Update Endpoint

<Expandable title="PUT /webhook">

- **Purpose**: Configure the webhook endpoint OFAuth will call for account events.
- **Endpoint**: `PUT /v2/account/webhook`
- **Headers**: `apikey` (required), `Content-Type: application/json`
- **Body fields**:

| Field | Type   | Required | Description |
| ----- | ------ | -------- | ----------- |
| `url` | string | Yes | HTTPS endpoint that receives webhook payloads |
| `events` | array | Yes | List of event types to subscribe to |

- **Available events**: `connection.created`, `connection.updated`, `connection.expired`, `rules.updated`
- **Response**: Confirms the webhook configuration, including the persisted URL, subscribed events, and timestamps.

</Expandable>

### Retrieve Configuration

<Expandable title="GET /webhook">

- **Purpose**: Retrieve the webhook configuration currently stored for your organization.
- **Endpoint**: `GET /v2/account/webhook`
- **Response**: Returns the configured URL, subscribed events, delivery timestamps, and current status.

</Expandable>

### Remove Webhook

<Expandable title="DELETE /webhook">

- **Purpose**: Remove the webhook configuration and stop future deliveries.
- **Endpoint**: `DELETE /v2/account/webhook`
- **Response**: Returns a success indicator confirming the webhook has been removed.

</Expandable>

## Supported Events

### Event Schema

Every webhook payload includes:

- `eventType`: Name of the event such as `connection.created` or `rules.updated`.
- `live`: Boolean indicating whether the event originated from production or test environments.
- `data`: Object containing resource-specific fields (connection snapshot or dynamic rules revision).

### Connection Events

| Event Type | Trigger | Data Included |
| ---------- | ------- | ------------- |
| `connection.created` | New connection established | Full connection object, user metadata, client reference ID |
| `connection.updated` | Connection details changed | Updated connection object with `updatedAt` timestamp |
| `connection.expired` | Connection lost or invalidated | Connection ID, status set to `expired`, `expiredAt` timestamp |

### System Events

| Event Type | Trigger | Data Included |
| ---------- | ------- | ------------- |
| `rules.updated` | Dynamic rules changed | Complete rules payload plus revision identifier |

## Delivery Behavior

### Retry Policy

OFAuth automatically retries failed webhook deliveries:

- Immediate retry on the first failure.
- Exponential backoff at 1, 2, 4, and 8 minute intervals.
- Maximum of 5 attempts per event.
- 10 second timeout per request.

If all retries fail, the event is marked as undelivered and no further attempts are made.

### Security Requirements

Protect your webhook endpoint with layered controls:

- **HTTPS only**: Maintain valid TLS certificates for delivery.
- **Authentication**: Require a shared secret or validate the OFAuth signature before processing.
- **IP restrictions**: Optionally restrict traffic to OFAuth's published egress ranges.

## Implementation Checklist

1. Accept `application/json` payloads, parse the body, and validate authenticity before use.
2. Branch on `eventType` and route to the appropriate handler for connections or rules events.
3. Persist connection state changes or update cached rules directly from the payload.
4. Respond with a `2xx` status within 10 seconds to avoid retries; offload long-running work to background jobs.
5. Record event IDs to ensure idempotent processing when OFAuth retries deliveries.

## Error Handling

<AccordionGroup>

<Accordion title="Webhook URL Invalid">
**Error code**: `INVALID_WEBHOOK_URL`

**What it means**: The provided webhook URL is not HTTPS.

**Fix it**: Update the configuration to use an HTTPS endpoint.
</Accordion>

<Accordion title="Webhook Delivery Failed">
**Error code**: `WEBHOOK_DELIVERY_FAILED`

**What it means**: OFAuth exhausted retry attempts and stopped delivering events to the configured URL.

**Fix it**: Restore your endpoint and respond with a `2xx` status so future deliveries succeed.
</Accordion>

<Accordion title="Connection Not Found">
**Error code**: `CONNECTION_NOT_FOUND`

**What it means**: The referenced connection ID does not exist or is not associated with your organization.

**Fix it**: Verify the identifier before sending management requests.
</Accordion>

</AccordionGroup>

## Best Practices

- Handle duplicate webhook deliveries gracefully by storing processed event IDs.
- Monitor latency, success rates, and retry counts to detect delivery issues.
- Cache dynamic rules from `rules.updated` events so you can apply them without extra API calls.
- Maintain clear runbooks for rotating secrets and updating webhook URLs during incident response.

## Next Steps

<CardGroup cols={3}>
	<Card title="Account API" icon="user" href="/guides/account">
		Manage account settings and connection lists
	</Card>
	<Card title="Rate Limiting" icon="gauge" href="/architecture/rate-limiting">
		Design for request quotas and burst handling
	</Card>
	<Card title="Error Handling" icon="exclamation-triangle" href="/architecture/error-handling">
		Build resilient retry and logging flows
	</Card>
</CardGroup>
