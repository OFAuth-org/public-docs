---
title: "Authentication"
description: "How to authenticate with the OFAuth API using API keys and connection IDs"
---

## Overview

OFAuth uses a simple two-header authentication model:

| Header | Purpose | Required |
|--------|---------|----------|
| `apiKey` | Identifies your organization | Always |
| `x-connection-id` | Identifies which OnlyFans account to act on | For Access API calls |

The SDK handles setting these headers automatically based on the values you provide during initialization or per-request.

## Client Initialization

Set your API key and an optional default connection ID when creating the client:

```csharp
using OFAuth;

var client = new OFAuthClient(
    apiKey: Environment.GetEnvironmentVariable("OFAUTH_API_KEY")
).WithConnectionId("conn_xxx");  // optional default for Access API calls
```

## API Key

Your API key authenticates your organization with the OFAuth API. It is sent as the `apiKey` header on every request.

- **Production keys** start with `sk_live_...`
- **Sandbox keys** start with `sk_sandbox_...`

Get your API key from the [OFAuth Dashboard](https://app.ofauth.com/platform/developers/keys).

<Warning>
  Keep your API key secret. Do not commit it to version control or expose it in client-side code.
</Warning>

## Connection ID

A connection ID identifies a specific connected OnlyFans account. It is required for all **Access API** calls (reading posts, earnings, subscribers, etc.) and is sent as the `x-connection-id` header.

Connection IDs are obtained through the [OFAuth Link flow](/guides/link) when a user authenticates their OnlyFans account. They look like `conn_xxx`.

### Setting a Default Connection ID

If your application works with a single connection at a time, set the connection ID on the client during initialization:

```csharp
var client = new OFAuthClient("your-api-key")
    .WithConnectionId("conn_xxx");

// All Access API calls use the default connection ID
var profile = await client.GetAsync<SelfResponse>("/v2/access/self");
var posts = await client.GetAsync<PostsListResponse>("/v2/access/posts");
```

### Per-Request Connection ID Override

If your application manages multiple connections, you can override the connection ID on individual requests:

```csharp
// Pass connectionId as a parameter
var profile = await client.GetAsync<SelfResponse>(
    "/v2/access/self",
    connectionId: "conn_other"
);
```

<Info>
  The per-request connection ID takes precedence over the default set on the client.
</Info>

## Account vs Access API Authentication

**Account API** calls only require the API key. No connection ID is needed:

```csharp
// No connection ID needed
var account = await client.GetAsync<WhoamiResponse>("/v2/account/whoami");
var connections = await client.GetAsync<ConnectionsListResponse>("/v2/account/connections");
```

**Access API** calls require both the API key and a connection ID:

```csharp
// Connection ID required (set on client or per-request)
var profile = await client.GetAsync<SelfResponse>("/v2/access/self");
var earnings = await client.GetAsync<EarningsChartResponse>(
    "/v2/access/earnings/chart",
    query: new Dictionary<string, string?>
    {
        ["startDate"] = "2024-01-01",
        ["endDate"] = "2024-01-31"
    }
);
```

## Environment Variables

Store your credentials in environment variables rather than hardcoding them:

```bash .env
# Your OFAuth API key
OFAUTH_API_KEY=sk_live_your_api_key_here

# Default connection ID (optional)
OFAUTH_CONNECTION_ID=conn_xxx
```

```csharp
var client = new OFAuthClient(
    apiKey: Environment.GetEnvironmentVariable("OFAUTH_API_KEY")
).WithConnectionId(
    Environment.GetEnvironmentVariable("OFAUTH_CONNECTION_ID")
);
```

<Warning>
  Never commit `.env` files to version control. Add `.env` to your `.gitignore`.
</Warning>

## Next Steps

<CardGroup cols={2}>
  <Card title="Configuration" icon="gear" href="/sdk/csharp/core-concepts/configuration">
    Customize base URLs, HTTP clients, and timeouts
  </Card>
  <Card title="Architecture" icon="sitemap" href="/sdk/csharp/core-concepts/architecture">
    Understand SDK structure and API namespaces
  </Card>
</CardGroup>
